<!doctype HTML>
<html lang="en">
    <head>
        <link href="/css/2022-08-29.css" rel="stylesheet">
        <meta charset="utf-8">
        <meta content="summary" name="twitter:card">
        <meta content="A page from the Substrate manual" name="twitter:description">
        <meta content="https://src-bin.com/img/apple-touch-icon.png" name="twitter:image">
        <meta content="@src_bin" name="twitter:site">
        <meta content="Source &amp; Binary / Substrate manual / Adding administrators to your AWS organization" name="twitter:title">
        <meta content="width=device-width,initial-scale=1" name="viewport">
        <meta content="A page from the Substrate manual" property="og:description">
        <meta content="https://src-bin.com/img/apple-touch-icon.png" property="og:image">
        <meta content="Source &amp; Binary / Substrate manual / Adding administrators to your AWS organization" property="og:title">
        <meta content="website" property="og:type">
        <meta content="https://src-bin.com/substrate/manual/adding-administrators/" property="og:url">
        <title>Source &amp; Binary / Adding administrators to your AWS organization</title>
    </head>
    <body>
        <header>
            <h1><a href="/">Source <span class="fancy">&amp;</span> Binary</a></h1>
            <p><a href="mailto:hello@src-bin.com">hello@src-bin.com</a></p>
            <aside>Purveyors&nbsp;of&nbsp;secure,&nbsp;reliable,&nbsp;and&nbsp;compliant&nbsp;cloud&nbsp;infrastructure&nbsp;since&nbsp;2020</aside>
            <nav>
                <ul>
                    <li><a href="/substrate/">Substrate</a></li>
                    <li><a href="/substrate/manual/">Documentation</a></li>
                    <li><a href="/substrate/pricing/">Pricing</a></li>
                    <!--<li><a href="/compliance/">Compliance Workshop</a></li>-->
                </ul>
            </nav>
        </header>

        <section>

<h1>Adding administrators to your AWS organization</h1>

<p>The Administrator role in all your Substrate-managed AWS accounts is managed outside of Terraform because Substrate configures Terraform to assume the Administrator role during Terraform runs. A classing chicken-and-egg problem. By default, the Administrator role in your admin account(s) can assume the Administrator role in all your service accounts and human users with the <code>RoleName</code> attribute set to &ldquo;Administrator&rdquo; in your identity provider can assume the Administrator role in your admin account(s). And while that&rsquo;s very often enough, there are plenty of reasons you might want to extend&nbsp;this.</p>

<p>You may have additional human users that can&rsquo;t, for whatever reason, be granted accounts in your identity provider. You may choose to grant these folks access via an IAM user (with two-factor authentication, of course!), via a separate AWS account to which they already have access, or by using Terraform to configure a parallel identity provider they can access. In all of these cases, these users will will need to assume the Administrator&nbsp;role.</p>

<p>You similarly may wish to grant a third-party SaaS CI/CD product access to run <code>terraform apply</code> (or <code>substate create-account</code>) on your behalf. If you&rsquo;re using GitHub Actions, you can follow their guide to <a href="https://docs.github.com/en/actions/deployment/security-hardening-your-deployments/configuring-openid-connect-in-amazon-web-services">configuring OpenID Connect in Amazon Web Services</a> to arrange for GitHub Actions to assume roles in your AWS accounts without managing an IAM user (which can&rsquo;t have two-factor authentication!) and a handing long-lived and very privileged access key to a third party. If you&rsquo;re not using GitHub Actions and the third party can&rsquo;t be configured to assume a role then you might have to create an IAM user and access key. In all of these cases, too, these principals will need to assume the Administrator&nbsp;role.</p>

<p>To allow additional principals, whether IAM user or roles and whether they&rsquo;re coming from AWS accounts you control or don&rsquo;t, and regardless of whether they came directly or via an integration with another identity provider, you can populate the <code>substrate.Administrator.assume-role-policy.json</code> file in your Substrate&nbsp;repository.</p>

<p>The contents of <code>substrate.Administrator.assume-role-policy.json</code> must be a well-formed JSON document in the structure of an AWS IAM assume role policy. Statements in this file must specify <code>"Action"</code> as one or more of the <code>sts:AssumeRole</code> family of actions, must <em>not</em> specify a <code>"Resource"</code>, and must specify one or more <code>"Principal"</code> identifiers (most likely IAM user or role&nbsp;ARNs).</p>

<p>The simplest <code>substrate.Administrator.assume-role-policy.json</code> looks like&nbsp;this:</p>

<pre><code>{
  "Version": "2012-10-17",
  "Statement": [
    {
      "Effect": "Allow",
      "Principal": {
        "AWS": [
          "arn:aws:iam::ACCOUNT_NUMBER:role/ROLE_NAME"
        ]
      },
      "Action": "sts:AssumeRole"
    }
  ]
}
</code></pre>

<p>You can include as many principals as you&rsquo;d like in the innermost&nbsp;list.</p>

<p>Every time you update this file, you&rsquo;ll need to re-run <code>substrate create-admin-account -quality <em>quality</em></code> in order to update the Administrator role in all the relevant accounts. This policy will be merged with the policy Substrate generates for the Administrator role (since roles may only have a single assume-role&nbsp;policy).</p>

<p>Once successfully applied, your additional administrators will be able to assume the Administrator role in all your&nbsp;accounts.</p>

<p>Note, too, that this pattern can be applied to the Auditor role using the <code>substrate.Auditor.assume-role-policy.json</code> file per <a href="../auditing/">auditing your Substrate-managed AWS organization</a>.</p>

        </section>

        <footer>
            <p class="fine-print">&copy; 2020-2022 &mdash; Source <span class="fancy">&amp;</span> Binary&nbsp;LLC</p>
        </footer>
        <script async src="https://www.googletagmanager.com/gtag/js?id=G-T1M8F1RWMC"></script>
        <script>
            window.dataLayer = window.dataLayer || [];
            function gtag(){dataLayer.push(arguments);}
            gtag('js', new Date());
            gtag('config', 'G-T1M8F1RWMC');
        </script>
    </body>
</html>
